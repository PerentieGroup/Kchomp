<script src="/static/home.js"></script>

<div class="homeBox">

    <div class="welcomeText">
        KCHOMP
    </div>

    <div class="welcomeSubText">
        Welcome to the best open source Komodo & KMD Assetchain mining pool.
    </div>

    <div class="features">
        <div class="fHead">
            Multi-Coin
        </div>
            <div class="fBody">
                Enjoy all your favourite mining on one pool. 
            </div>
    </div>

    <div class="features">
        <div class="fHead">
            Easy to use
        </div>
            <div class="fBody">
                Easy to setup and configure.
            </div>
    </div>

    <div class="features">
            <div class="fHead">
                Up-to-date
            </div>
                <div class="fBody">
                    Always being updated with the latest configuration requirements.
                </div>
    </div>
</div>

<div id="holder">
    <div id="menu">

        <div id="poolFeatures" class="menuHeader" style="text-align: center; margin: 10px">
            Pool Features
        </div>
            
    <div class="menuHeader" style="text-align: center; margin: 10px">
            Pool Overview
    </div>

        {{ for(var pool in it.stats.pools) { }}
            <div class="menuHeader" style="text-align: center; margin: 10px">
                    {{=it.stats.pools[pool].name}}
            </div>

            <div class="flex-container">
                <div class="bannerHome">
                        <div class="boxLowerHeaderHome">Block Height</div>
                                <div class="infotextHome">
                                    <span id="statsNetworkBlocks{{=pool}}">{{=it.stats.pools[pool].poolStats.networkBlocks}}</span>
                                </div>                         
                </div>

                <div class="bannerHome">
                        <div class="boxLowerHeaderHome">Difficulty</div>
                                <div class="infotextHome">
                                        <span id="statsNetworkDiff{{=pool}}">{{=it.stats.pools[pool].poolStats.networkDiff}}</span>
                                </div>                         
                </div>

                <div class="bannerHome">
                        <div class="boxLowerHeaderHome">Network Hash</div>
                                <div class="infotextHome">
                                        <span id="statsNetworkSols{{=pool}}">{{=it.stats.pools[pool].poolStats.networkSolsString}}</span>
                                </div>                         
                </div>

                <div class="bannerHome">
                        <div class="boxLowerHeaderHome">Pool Hash</div>
                            <div class="infotextHome">
                                <span id="statsHashrate{{=pool}}">{{=it.stats.pools[pool].hashrateString}}</span> 
                            </div>
                </div>

                <div class="bannerHome">
                        <div class="boxLowerHeaderHome">Blocks Found</div>
                            <div class="infotextHome">
                                <span id="#statsValidBlocks{{=pool}}">{{=it.stats.pools[pool].poolStats.validBlocks}}</span> 
                            </div>
                </div>

                <div class="bannerHome">
                    <div class="boxLowerHeaderHome">Total Paid</div>
                        <div class="infotextHome">
                            <span id="statsTotalPaid{{=pool}}"><div>{{=(parseFloat(it.stats.pools[pool].poolStats.totalPaid)).toFixed(2)}}</div>
                        </div>
                </div>

                <div class="bannerHome">
                        <div class="boxLowerHeaderHome">Node Connections:</div>
                            <div class="infotextHome">
                                <span id="statsNetworkConnections{{=pool}}">{{=it.stats.pools[pool].poolStats.networkConnections}}</span>
                            </div>
                    </div>
            </div>
        {{ } }}
    </div>
</div>



<script>
    //document.querySelector('main').appendChild(document.createElement('script')).src = '/static/stats.js';

    $(function() {
        window.statsSource = new EventSource("/api/live_stats");

        statsSource.addEventListener('message', function (e) {
            var stats = JSON.parse(e.data);
            for (var pool in stats.pools) {
				$('#statsMiners' + pool).text(stats.pools[pool].minerCount);
                $('#statsWorkers' + pool).text(stats.pools[pool].workerCount);
                $('#statsHashrate' + pool).text(stats.pools[pool].hashrateString);
				$('#statsHashrateAvg' + pool).text(getReadableHashRateString(calculateAverageHashrate(pool)));
				$('#statsLuckDays' + pool).text(stats.pools[pool].luckDays);
				$('#statsValidBlocks' + pool).text(stats.pools[pool].poolStats.validBlocks);
				$('#statsTotalPaid' + pool).text((parseFloat(stats.pools[pool].poolStats.totalPaid)).toFixed(8));
				$('#statsNetworkBlocks' + pool).text(stats.pools[pool].poolStats.networkBlocks);
				$('#statsNetworkDiff' + pool).text(stats.pools[pool].poolStats.networkDiff);
				$('#statsNetworkSols' + pool).text(getReadableNetworkHashRateString(stats.pools[pool].poolStats.networkSols));
				$('#statsNetworkConnections' + pool).text(stats.pools[pool].poolStats.networkConnections);
            }
            
            for (algo in stats.algos) {
                $('#statsMiners' + algo).text(stats.algos[algo].workers);
                $('#statsHashrate' + algo).text(stats.algos[algo].hashrateString);
            }
        });
    });
</script>